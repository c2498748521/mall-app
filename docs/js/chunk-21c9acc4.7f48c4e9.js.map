{"version":3,"sources":["webpack:///./src/views/layout/Register.vue?d2e5","webpack:///./src/views/layout/Register.vue?4261","webpack:///./src/api/register.js","webpack:///src/views/layout/Register.vue","webpack:///./src/views/layout/Register.vue?2758","webpack:///./src/views/layout/Register.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_b","ref","attrs","ruleForm","rules","layout","_v","model","value","callback","$$v","$set","expression","key","on","handleChange","staticStyle","_n","handleSendCode","span","offset","$event","submitForm","resetForm","staticRenderFns","register","params","axios","post","sendCode","data","Error","reg","test","username","email","pass","checkPass","code","role","labelCol","wrapperCol","methods","$refs","formName","validate","valid","password","console","log","resetFields","val","timer","$message","error","content","setTimeout","component"],"mappings":"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","file":"js/chunk-21c9acc4.7f48c4e9.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Register.vue?vue&type=style&index=0&id=b5f4a266&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"register\"},[_c('a-form-model',_vm._b({ref:\"ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules}},'a-form-model',_vm.layout,false),[_c('h1',{staticClass:\"title\"},[_vm._v(\" 注册 \"),_c('router-link',{attrs:{\"to\":\"/login\"}},[_vm._v(\"已有账号？去登陆\")])],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"用户名\",\"prop\":\"username\"}},[_c('a-input',{attrs:{\"type\":\"text\",\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.username),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"username\", $$v)},expression:\"ruleForm.username\"}})],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"邮箱\",\"prop\":\"email\"}},[_c('a-input',{attrs:{\"type\":\"text\",\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.email),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"email\", $$v)},expression:\"ruleForm.email\"}})],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"密码\",\"prop\":\"pass\"}},[_c('a-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.pass),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"pass\", $$v)},expression:\"ruleForm.pass\"}})],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"确认密码\",\"prop\":\"checkPass\"}},[_c('a-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.checkPass),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"checkPass\", $$v)},expression:\"ruleForm.checkPass\"}})],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"用户类型\",\"prop\":\"role\"}},[_c('a-select',{attrs:{\"label-in-value\":\"\",\"default-value\":{ key: 'customer' }},on:{\"change\":_vm.handleChange}},[_c('a-select-option',{attrs:{\"value\":\"customer\"}},[_vm._v(\" 普通用户 \")]),_c('a-select-option',{attrs:{\"value\":\"admin\"}},[_vm._v(\" 管理员 \")])],1)],1),_c('a-form-model-item',{attrs:{\"has-feedback\":\"\",\"label\":\"验证码\",\"prop\":\"code\"}},[_c('a-input',{staticStyle:{\"width\":\"150px\"},attrs:{\"type\":\"text\",\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.code),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"code\", _vm._n($$v))},expression:\"ruleForm.code\"}}),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSendCode}},[_vm._v(\"获取验证码\")])],1),_c('a-form-model-item',{attrs:{\"wrapper-col\":{ span: 14, offset: 4 }}},[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleForm')}}},[_vm._v(\" 注册 \")]),_c('a-button',{staticStyle:{\"margin-left\":\"10px\"},on:{\"click\":function($event){return _vm.resetForm('ruleForm')}}},[_vm._v(\" 重置 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import axios from '@/axios';\n\nexport default {\n  register(params) {\n    return axios.post('/passport/logon', params);\n  },\n  sendCode(params) {\n    return axios.post('/passport/getCode', params);\n  },\n};\n","<template>\n  <div class=\"register\">\n    <a-form-model\n      ref=\"ruleForm\"\n      :model=\"ruleForm\"\n      :rules=\"rules\"\n      v-bind=\"layout\"\n    >\n      <h1 class=\"title\">\n        注册\n        <router-link to=\"/login\">已有账号？去登陆</router-link>\n      </h1>\n      <a-form-model-item has-feedback label=\"用户名\" prop=\"username\">\n        <a-input v-model=\"ruleForm.username\" type=\"text\" autocomplete=\"off\" />\n      </a-form-model-item>\n      <a-form-model-item has-feedback label=\"邮箱\" prop=\"email\">\n        <a-input v-model=\"ruleForm.email\" type=\"text\" autocomplete=\"off\" />\n      </a-form-model-item>\n      <a-form-model-item has-feedback label=\"密码\" prop=\"pass\">\n        <a-input v-model=\"ruleForm.pass\" type=\"password\" autocomplete=\"off\" />\n      </a-form-model-item>\n      <a-form-model-item has-feedback label=\"确认密码\" prop=\"checkPass\">\n        <a-input\n          v-model=\"ruleForm.checkPass\"\n          type=\"password\"\n          autocomplete=\"off\"\n        />\n      </a-form-model-item>\n      <a-form-model-item has-feedback label=\"用户类型\" prop=\"role\">\n        <a-select\n          label-in-value\n          :default-value=\"{ key: 'customer' }\"\n          @change=\"handleChange\"\n        >\n          <a-select-option value=\"customer\"> 普通用户 </a-select-option>\n          <a-select-option value=\"admin\"> 管理员 </a-select-option>\n        </a-select>\n      </a-form-model-item>\n      <a-form-model-item has-feedback label=\"验证码\" prop=\"code\">\n        <a-input\n          style=\"width: 150px\"\n          v-model.number=\"ruleForm.code\"\n          type=\"text\"\n          autocomplete=\"off\"\n        />\n        <a-button type=\"primary\" @click=\"handleSendCode\">获取验证码</a-button>\n      </a-form-model-item>\n      <a-form-model-item :wrapper-col=\"{ span: 14, offset: 4 }\">\n        <a-button type=\"primary\" @click=\"submitForm('ruleForm')\">\n          注册\n        </a-button>\n        <a-button style=\"margin-left: 10px\" @click=\"resetForm('ruleForm')\">\n          重置\n        </a-button>\n      </a-form-model-item>\n    </a-form-model>\n  </div>\n</template>\n<script>\nimport api from '@/api/register';\n\nexport default {\n  data() {\n    const validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码!'));\n      } else {\n        if (this.ruleForm.checkPass !== '') {\n          this.$refs.ruleForm.validateField('checkPass');\n        }\n        callback();\n      }\n    };\n    const validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码!'));\n      } else if (value !== this.ruleForm.pass) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n    const validateEmail = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入邮箱!'));\n      } else {\n        const reg = /^([a-zA-Z]|[0-9])(\\w|-)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/;\n        if (reg.test(value)) {\n          // 验证通过\n          this.$refs.ruleForm.validateField('email');\n        } else {\n          callback(new Error('请输入格式正确的邮箱!'));\n        }\n        callback();\n      }\n    };\n    const validateUser = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入用户名!'));\n      } else {\n        this.$refs.ruleForm.validateField('username');\n        callback();\n      }\n    };\n    const validateCode = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入验证码!'));\n      } else {\n        this.$refs.ruleForm.validateField('code');\n        callback();\n      }\n    };\n    return {\n      ruleForm: {\n        username: '',\n        email: '',\n        pass: '',\n        checkPass: '',\n        code: '',\n        role: 'customer',\n      },\n      rules: {\n        pass: [{ validator: validatePass, trigger: 'change' }],\n        checkPass: [{ validator: validatePass2, trigger: 'change' }],\n        email: [{ validator: validateEmail, trigger: 'change' }],\n        username: [{ validator: validateUser, trigger: 'change' }],\n        code: [{ validator: validateCode, trigger: 'change' }],\n      },\n      layout: {\n        labelCol: { span: 4 },\n        wrapperCol: { span: 14 },\n      },\n    };\n  },\n  methods: {\n    submitForm(formName) {\n      // 提交表单\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          const {\n            email, pass, code, username, role,\n          } = this.ruleForm;\n          const params = {\n            email,\n            password: pass,\n            code,\n            username,\n            role,\n          };\n          api.register(params).then(\n            (res) => {\n              this.$message.success({\n                content: res,\n              });\n              this.$router.push('/login');\n            },\n            (err) => {\n              this.$message.error({\n                content: err,\n              });\n            },\n          );\n          return true;\n        }\n        console.log('error submit!!');\n        return false;\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    handleChange(val) {\n      this.ruleForm.role = val.key;\n    },\n    handleSendCode() {\n      const { email } = this.ruleForm;\n      const reg = /^([a-zA-Z]|[0-9])(\\w|-)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/;\n      if (reg.test(email)) {\n        // 验证通过\n        const params = {\n          email,\n        };\n        if (this.timer) {\n          this.$message.error({\n            content: '验证码发送太频繁，请稍后再试',\n          });\n          return;\n        }\n        this.timer = setTimeout(() => {\n          this.timer = null;\n        }, 60 * 1000);\n\n        api.sendCode(params).then(() => {\n          this.$message.success({\n            content: '验证码已发送致您的邮箱，请注意查收',\n          });\n        });\n      } else {\n        this.$message.error({\n          content: '请输入正确的邮箱后再获取验证码',\n        });\n      }\n    },\n  },\n};\n</script>\n<style scoped>\n@import url(\"~@/assets/css/login.less\");\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Register.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Register.vue?vue&type=template&id=b5f4a266&scoped=true&\"\nimport script from \"./Register.vue?vue&type=script&lang=js&\"\nexport * from \"./Register.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Register.vue?vue&type=style&index=0&id=b5f4a266&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b5f4a266\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}